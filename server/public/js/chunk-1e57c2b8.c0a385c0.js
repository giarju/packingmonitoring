(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1e57c2b8"],{"2ef7":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"container",attrs:{id:"po_selection"}},[a("div",{staticClass:"row"},[a("b-dropdown",{staticClass:"mt-2",attrs:{text:"Pilih Nomor Order",variant:"dark","menu-class":"w-100"},on:{show:t.dd_event}},t._l(t.po_items,(function(e){return a("b-dropdown-item",{key:e.po_code,on:{click:function(a){return t.dd_item_click(e.po_code)}}},[t._v(" "+t._s(e.po_code)+" ")])})),1)],1),a("b-alert",{staticClass:"mt-2 container",attrs:{dismissible:"",variant:"danger"},model:{value:t.qr_alert,callback:function(e){t.qr_alert=e},expression:"qr_alert"}},[t._v(" Belum ada PO! ")])],1),a("div",{staticClass:"container",attrs:{id:"description"}},[a("div",{staticClass:"row pt-2"},[a("div",{staticClass:"col"},[t.istableloaded?a("p",[t._v("Material : "+t._s(t.table_items[t.current_row].po_code))]):t._e()]),a("div",{staticClass:"col"},[t.istableloaded?a("p",[t._v("Batch : "+t._s(t.table_items[t.current_row].batch))]):t._e()])]),a("div",{staticClass:"row"},[a("div",{staticClass:"col"},[t.istableloaded?a("p",[t._v("Kode Feed : "+t._s(t.table_items[t.current_row].feed_code))]):t._e()]),a("div",{staticClass:"col"},[t.istableloaded?a("p",[t._v("Material : "+t._s(t.table_items[t.current_row].material))]):t._e()])])]),a("div",{class:[t.weigh_inactive||!t.po_exist?"bg-secondary":t.weigh_success?"bg-success":"bg-danger","container","text-white","text-center"],attrs:{id:"weight"}},[a("div",{staticClass:"row pt-2 pb-3"},[a("div",{staticClass:"col"},[t.istableloaded?a("h1",[t._v("Material : "+t._s(t.table_items[t.current_row].material))]):t._e()]),a("div",{staticClass:"col"},[t.istableloaded?a("h1",[t._v("Target : "+t._s(t.table_items[t.current_row].target_weight.toFixed(2))+" +/- "+t._s(t.table_items[t.current_row].tolerance.toFixed(2))+" Kg")]):t._e()])]),a("div",{staticClass:"row p-4"},[a("div",{staticClass:"col"},[a("h1",{staticClass:"display-1"},[a("strong",[t._v(t._s(t.weight.toFixed(2))+" Kg")])])])]),a("div",{staticClass:"row p-3"},[a("div",{staticClass:"col"},[a("b-button",{attrs:{variant:"light"},on:{click:function(e){return t.weight_click()}}},[t._v("Lanjut")])],1)])]),a("div",{staticClass:"container"},[a("b-row",{staticClass:" mt-2"},[a("b-col",[a("h6",[t._v("Batch : "+t._s(t.material_filter))])]),a("b-col",[a("b-pagination",{attrs:{"total-rows":t.material_total_rows,"per-page":t.material_per_page,align:"fill",size:"sm"},model:{value:t.material_filter,callback:function(e){t.material_filter=e},expression:"material_filter"}})],1)],1)],1),t.istableloaded?a("div",{staticClass:"container mt-3 scrollable",attrs:{id:"list-material"}},[a("b-table",{attrs:{hover:"",fixed:"","filter-included-fields":t.material_filt_on,filter:""+t.material_filter,fields:t.material_fields,items:t.table_items,"tbody-tr-class":t.rowClass,"head-variant":"dark"},scopedSlots:t._u([{key:"cell(action)",fn:function(e){return[a("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(a){e.item.actual_weight=t.action_click(e.item.actual_weight,e.index)}}},[t._v(" Ubah ")])]}}],null,!1,3887289221)})],1):t._e(),a("div",{staticClass:"container mt-2"},[a("div",{staticClass:"row"},[a("b-alert",{staticClass:"mt-2 container",attrs:{dismissible:"",variant:"danger"},model:{value:t.save_alert,callback:function(e){t.save_alert=e},expression:"save_alert"}},[t._v(" Berat masih salah! ")]),a("b-button",{attrs:{variant:"dark"},on:{click:function(e){return t.save_click()}}},[t._v(" Simpan ")])],1)])])},r=[],n=a("1da1"),s=(a("96cf"),a("c740"),a("d81d"),a("caad"),a("2532"),a("b0c0"),a("bc3a")),l=a.n(s),o={components:{},data:function(){return{timer:0,stable_time:2,weight:0,current_row:0,current_id:0,qr_alert:!1,po_exist:!1,save_alert:!1,form_qr:"",weigh_inactive:!0,weigh_success:!1,istableloaded:!1,po_items:[],table_items:[],material_total_rows:1,material_per_page:1,material_filter:1,material_filt_on:["batch"],material_fields:[{key:"material",label:"Material"},{key:"target_weight",label:"Target"},{key:"actual_weight",label:"Aktual"},{key:"action",label:"Aksi"}]}},mounted:function(){var t=this;setInterval((function(){t.timer=t.timer+1,t.timer>t.stable_time&&t.weigh_success&&!t.weigh_inactive&&(t.weight_click(),t.timer=0,t.weigh_inactive=!0),t.weigh_inactive&&t.weight<.5&&t.weight>-.5&&(t.weigh_inactive=!1)}),1e3)},methods:{hide_modal:function(){this.$refs["qrscan-modal-ref"].hide()},weight_click:function(){if(!this.weigh_inactive&&this.po_exist){this.table_items[this.current_row].actual_weight=this.weight;var t=this.table_items.map((function(t){return t.actual_weight})).findIndex((function(t){return null===t}));-1!==t&&(this.current_row=t,this.current_id=this.table_items[this.current_row].id),this.material_filter=Math.floor(this.current_row/this.material_per_page)+1}},action_click:function(t,e){return t=null,this.current_row=e+(this.material_filter-1)*this.material_per_page,this.current_id=this.table_items[this.current_row].id,t},save_click:function(){var t=this;this.save_alert=!1;var e=!this.table_items.map((function(t){return t.actual_weight})).includes(null),a=!this.table_items.map((function(t){return Math.abs(t.target_weight-t.actual_weight)<t.tolerance})).includes(!1);a&&e?l.a.put("/api/weigh/update",{timeout:5e3,data:this.table_items}).then((function(e){console.log(e),t.material_total_rows=0,t.material_per_page=0,t.table_items=[],t.weigh_inactive=!0,t.istableloaded=!1,t.save_alert=!1})).catch((function(t){console.error(t)})):this.save_alert=!0},dd_event:function(){var t=this;this.po_items=[],l.a.get("/api/weigh/code",{timeout:5e3}).then((function(e){t.qr_alert=!1,e.data.length>0?(t.po_items=e.data,console.log(e.data),t.qr_alert=!1):(t.qr_alert=!0,t.po_items=[])})).catch((function(e){t.qr_alert=!0,t.po_items=[],console.error(e)}))},dd_item_click:function(t){var e=this;l.a.get("/api/weigh?qrcode='".concat(t,"'"),{timeout:5e3}).then((function(t){if(t.data.length>0){e.material_total_rows=t.data.length,e.material_per_page=Math.floor(t.data.length/Math.max.apply(Math,t.data.map((function(t){return t.batch})))),e.table_items=t.data,e.weigh_inactive=!1,e.istableloaded=!0,e.qr_alert=!1,e.po_exist=!0;var a=t.data.map((function(t){return t.actual_weight})).findIndex((function(t){return null===t}));-1!==a&&(e.current_row=a,e.current_id=e.table_items[e.current_row].id),console.log(e.table_items[e.current_row])}else e.weigh_inactive=!0,e.istableloaded=!1,e.qr_alert=!0,e.po_exist=!1})).catch((function(t){e.weigh_inactive=!0,e.istableloaded=!1,e.qr_alert=!0,e.po_exist=!1,console.error(t)}))},onDecode:function(t){var e=this;l.a.get("/api/weigh?qrcode='".concat(t,"'"),{timeout:5e3}).then((function(t){if(t.data.length>0){e.material_total_rows=t.data.length,e.material_per_page=Math.floor(t.data.length/Math.max.apply(Math,t.data.map((function(t){return t.batch})))),e.table_items=t.data,e.weigh_inactive=!1,e.istableloaded=!0,e.qr_alert=!1,e.hide_modal();var a=t.data.map((function(t){return t.actual_weight})).findIndex((function(t){return null===t}));-1!==a&&(e.current_row=a)}else e.weigh_inactive=!0,e.istableloaded=!1,e.qr_alert=!0,e.hide_modal()})).catch((function(t){e.weigh_inactive=!0,e.istableloaded=!1,e.qr_alert=!0,console.error(t),e.hide_modal()}))},onInit:function(t){var e=this;return Object(n["a"])(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t;case 3:a.next=8;break;case 5:a.prev=5,a.t0=a["catch"](0),"NotAllowedError"===a.t0.name?e.error="ERROR: you need to grant camera access permisson":"NotFoundError"===a.t0.name?e.error="ERROR: no camera on this device":"NotSupportedError"===a.t0.name?e.error="ERROR: secure context required (HTTPS, localhost)":"NotReadableError"===a.t0.name?e.error="ERROR: is the camera already in use?":"OverconstrainedError"===a.t0.name?e.error="ERROR: installed cameras are not suitable":"StreamApiNotSupportedError"===a.t0.name&&(e.error="ERROR: Stream API is not supported in this browser");case 8:case"end":return a.stop()}}),a,null,[[0,5]])})))()},rowClass:function(t,e){if(t&&"row"===e)return t.target_weight-t.actual_weight<t.tolerance&&t.target_weight-t.actual_weight>-t.tolerance?"table-success":t.id===this.current_id?"table-info":void 0},onSubmit:function(t){t.preventDefault()}},sockets:{connect:function(){console.log("socket connected")},disconnect:function(){console.log("disconnected")},newdata:function(t){this.weight=t,Math.abs(this.table_items[this.current_row].target_weight-this.weight)<this.table_items[this.current_row].tolerance?this.weigh_success=!0:this.weigh_success=!1,this.timer=0}}},c=o,_=(a("cde9"),a("2877")),d=Object(_["a"])(c,i,r,!1,null,"49c6e7ba",null);e["default"]=d.exports},c740:function(t,e,a){"use strict";var i=a("23e7"),r=a("b727").findIndex,n=a("44d2"),s="findIndex",l=!0;s in[]&&Array(1)[s]((function(){l=!1})),i({target:"Array",proto:!0,forced:l},{findIndex:function(t){return r(this,t,arguments.length>1?arguments[1]:void 0)}}),n(s)},cde9:function(t,e,a){"use strict";a("f441")},f441:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1e57c2b8.c0a385c0.js.map